# IDOR vulnerability with unpredictable IDs â€” Practitioner

**Status:** Solved

---

## Goal

Find and exploit an IDOR vulnerability where the resource IDs aren't sequential. You need to find Carlos's GUID and access his account information.

---

## Steps (simple & complete)

1. **Explore the application**
   - Browse around the website and look at different features
   - Check blog posts, user profiles, or any user-specific content
   - Notice how the application references users

2. **Find where GUIDs are leaked**
   - Look at blog posts or comments sections
   - Check the page source or API responses
   - Often GUIDs are exposed in:
     - Blog post author links
     - Comment sections
     - Profile page URLs
     - API responses in the background

3. **Locate Carlos's GUID**
   - Find a blog post written by Carlos or where he commented
   - Right-click and "View page source" or use Burp Suite
   - Look for something like:
```html
   <a href="/profile?id=4a9e8f2b-3c1d-4e6a-9b2f-7d8c3a1e5f4b">Carlos</a>
```
   - Copy Carlos's GUID

4. **Access your own account first**
   - Log in with your credentials (wiener:peter)
   - Go to "My account" page and observe the request:
```
   GET /my-account?id=YOUR-GUID-HERE
```

5. **Exploit the IDOR**
   - Replace your GUID with Carlos's GUID:
```bash
   curl -s "https://TARGET/my-account?id=CARLOS-GUID-HERE" \
     -H "Cookie: session=YOUR-SESSION-COOKIE"
```

6. **Retrieve the API key**
   - In the response, you'll see Carlos's account details
   - Look for his API key in the page content
   - Copy the API key

7. **Submit the solution**
   - The lab usually has a "Submit solution" button
   - Paste Carlos's API key to solve the lab

---

## Example

- Your account: `GET /my-account?id=abc123-your-guid`
- Carlos's GUID found in blog post source: `4a9e8f2b-3c1d-4e6a-9b2f-7d8c3a1e5f4b`
- IDOR payload:
```bash
curl -s "https://TARGET/my-account?id=4a9e8f2b-3c1d-4e6a-9b2f-7d8c3a1e5f4b" \
  -H "Cookie: session=your-session-here"
```

---

## Why this works

Even though the application uses unpredictable GUIDs instead of sequential IDs, it still doesn't verify if the logged-in user has permission to view the requested account. The GUIDs are also leaked in public areas like blog posts, making them discoverable. Security through obscurity isn't real security!

---

